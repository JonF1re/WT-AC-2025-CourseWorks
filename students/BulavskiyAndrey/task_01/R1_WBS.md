# Вариант 33 — WBS (эпики → фичи → задачи) — Органайзер «Без лишних чатов»

Фокус: R1/MVP с модулями объявлений, файлов, календаря, опросов и чатов, а также базовыми правами доступа.  
Бонусы: расширенные роли, дайджест, документация API, тесты, Kubernetes, CI.

---

## Эпик A. Модель данных и миграции

- **Фичи**: схемы `User`, `Group`, `Membership`, `Announcement`, `File`, `Event`, `Poll`, `Choice`, `Vote`, `Chat`, `Message`; базовые связи и ограничения.
- **Задачи**:
  - **A1.** Описать ER‑диаграмму и связи (см. `R1_ERD.md`).
  - **A2.** Подготовить миграции БД для основных сущностей.
  - **A3.** Настроить индексы для часто используемых запросов (чаты, объявления, события).
  - **A4.** Подготовить демо‑данные: тестовую группу, пользователей, несколько объявлений/событий/опросов.

---

## Эпик B. API и бизнес‑логика по модулям

- **Фичи**: REST API по основным ресурсам `/announcements`, `/files`, `/calendar`, `/polls`, `/chats` в контексте группы.
- **Задачи**:
  - **B1.** Реализовать CRUD‑эндпоинты для объявлений:
    - `GET/POST/PUT/DELETE /groups/{groupId}/announcements`.
  - **B2.** Реализовать API для файлов:
    - загрузка, список, скачивание, удаление `/groups/{groupId}/files`.
  - **B3.** Реализовать API для календаря:
    - список событий, создание/редактирование/удаление `/groups/{groupId}/calendar`.
  - **B4.** Реализовать API для опросов:
    - создание опросов, варианты, голосование и просмотр результатов `/groups/{groupId}/polls`.
  - **B5.** Реализовать API для чатов:
    - список чатов и сообщений, отправка/редактирование/удаление сообщений `/groups/{groupId}/chats`.
  - **B6.** Добавить пагинацию и фильтры для длинных списков (объявления, файлы, сообщения).

---

## Эпик C. Права доступа и роли

- **Фичи**: RBAC на уровне группы (admin, moderator, member, guest), проверка прав в API.
- **Задачи**:
  - **C1.** Описать роли и действия (см. `R1_Roles_and_Actions.md`).
  - **C2.** Сформировать матрицу прав (см. `R1_Matrix_of_Rights.md`).
  - **C3.** Реализовать middleware/guard для проверки:
    - роли участника в группе (`Membership.role`);
    - принадлежности к группе/чату;
    - владения ресурсами (своё сообщение, файл и т. д.).
  - **C4.** Ограничить доступ к опросам, чатам, файлам согласно матрице прав.
  - **C5.** Написать тестовые сценарии прав доступа (минимум happy‑path + пару негативных случаев).

---

## Эпик D. UI / Интерфейс пользователя

- **Фичи**: базовый интерфейс группы с дашбордом, объявлениями, файлами, календарём, опросами и чатами.
- **Задачи**:
  - **D1.** Страница дашборда группы:
    - последние объявления, ближайшие события, активные опросы, быстрый доступ к чатам.
  - **D2.** Страница объявлений:
    - список, фильтры, просмотр карточки объявления.
  - **D3.** Страница файлов:
    - список, фильтры, скачивание; форма загрузки (для ролей с правами).
  - **D4.** Страница календаря:
    - список/календарный вид событий, просмотр деталей.
  - **D5.** Страница опросов:
    - список, участие в опросе, просмотр результатов (если разрешено).
  - **D6.** Страница чатов:
    - список чатов, лента сообщений, отправка и базовое редактирование сообщений.

---

## Эпик E. Аутентификация и работа с группами

- **Фичи**: базовая аутентификация и привязка пользователя к группе.
- **Задачи**:
  - **E1.** Реализовать регистрацию/вход пользователя (набор: email + пароль).
  - **E2.** Реализовать выдачу токена (например, JWT) и хранение роли/идентификатора группы.
  - **E3.** Реализовать получение текущих групп пользователя и выбор активной группы.
  - **E4.** Ограничить все основные API маршруты контекстом группы `/groups/{groupId}/...`.

---

## Эпик F. Дайджест и уведомления (бонус)

- **Фичи**: формирование «дайджеста» и базовые уведомления.
- **Задачи**:
  - **F1.** Определить формат дайджеста (какие сущности и за какой период попадают).
  - **F2.** Реализовать сервис агрегации данных за период (объявления, события, опросы, файлы).
  - **F3.** Реализовать сохранение/отображение дайджеста внутри приложения (страница «Дайджест»).
  - **F4.** (Бонус) Добавить отправку дайджеста по e‑mail.
  - **F5.** (Бонус) Добавить базовые уведомления о новых событиях/объявлениях.

---

## Эпик G. Окружение, документация и CI (бонус)

- **Фичи**: инфраструктура, документация API, тесты, CI/CD.
- **Задачи**:
  - **G1.** Подготовить Dockerfile и docker‑compose для локального запуска.
  - **G2.** Описать OpenAPI/Swagger‑спецификацию для основных эндпоинтов.
  - **G3.** Написать unit‑ и интеграционные тесты для ключевых сценариев:
    - создание объявления, файла, события;
    - голосование в опросе;
    - отправка сообщений в чатах;
    - проверки прав доступа.
  - **G4.** Настроить CI‑pipeline (например, GitHub Actions) с прогоном тестов и линтеров.
  - **G5.** (Бонус) Подготовить Kubernetes‑манифесты для развёртывания.

---

## Приоритеты (MVP для R1)

1. **A1–A4** — модель данных и миграции (обязательно).
2. **B1–B5** — базовый API для объявлений, файлов, календаря, опросов и чатов.
3. **C1–C4** — роли и права доступа (критерий приёмки по условиям задания).
4. **D1–D6** — минимальный UI для работы групп.
5. **E1–E4** — аутентификация и привязка к группе.
6. **F1–F3** — базовый дайджест (как бонус, если останется время).
7. **G1–G4** — инфраструктура, API‑документация и тесты (как бонусы для сильного решения).
